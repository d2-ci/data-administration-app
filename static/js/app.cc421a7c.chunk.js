(this["webpackJsonp@dhis2/app-shell"]=this["webpackJsonp@dhis2/app-shell"]||[]).push([[135],{641:function(e,t,a){e.exports={container:"App_container__2zgzu",sidebar:"App_sidebar__10tAV",content:"App_content__3I8HS",contentWrapper:"App_contentWrapper__28dVZ"}},868:function(e,t,a){},869:function(e){e.exports=JSON.parse('{"Data set":"\u062d\u0632\u0645\u0629 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a","Period":"\u0627\u0644\u0641\u062a\u0631\u0629 \u0627\u0644\u0632\u0645\u0646\u064a\u0629","Organisation unit":"\u0627\u0644\u0648\u062d\u062f\u0629 \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629"}')},870:function(e){e.exports=JSON.parse("{}")},871:function(e){e.exports=JSON.parse('{"Data set":"","Period":"","Organisation unit":"\u0627\u0644\u0648\u062d\u062f\u0629 \u0627\u0644\u062a\u0646\u0638\u064a\u0645\u064a\u0629"}')},872:function(e){e.exports=JSON.parse("{}")},873:function(e){e.exports=JSON.parse("{}")},874:function(e){e.exports=JSON.parse('{"Data set":"","Period":"\u0645\u0627\u0648\u0629","Organisation unit":"\u064a\u0629\u0643\u0629\u064a \u0631\u064a\u0643\u062e\u0631\u0627\u0648"}')},875:function(e){e.exports=JSON.parse('{"Data set":"Datov\xe1 sada","Period":"Obdob\xed","Organisation unit":"Organiza\u010dn\xed jednotka"}')},876:function(e){e.exports=JSON.parse('{"Data set":"Data set","Period":"","Organisation unit":"Organisation unit"}')},877:function(e){e.exports=JSON.parse('{"Open user guide":"","Data Integrity":"","Run data integrity checks and unveil anomalies and problems in the metadata setup.":"","Check data integrity":"","An unexpected error happened during data integrity checks":"","Maintenance":"","Perform maintenance tasks and generate resource database tables for the organisation unit hierarchy and group set structure.":"","Perform maintenance":"","Clear analytics tables":"","Analyze analytics tables":"","Remove zero data values":"","Permanently remove soft deleted data values":"","Permanently remove soft deleted events":"","Permanently remove soft deleted enrollments":"","Permanently remove soft deleted tracked entity instances":"","Prune periods":"","Remove expired invitations":"","Drop SQL views":"","Create SQL views":"","Update category option combinations":"","Update organisation unit paths":"","Clear application cache":"","Reload apps":"","Resource Tables":"","Generate resource database tables for the organisation unit hierarchy and group set structure among others.":"","Generate Resource Tables":"","An unexpected error happened during operation":"","Organisation unit structure":"","Organisation unit category option combo":"","Category option group set structure":"","Data element group set structure":"","Indicator group set structure":"","Organisation unit group set structure":"","Category structure":"","Data element category option combo name":"","Data element structure":"","Period structure":"","Date period structure":"","Data element category option combinations":"","Analytics tables management":"","Analytics Tables":"","The data mart is a set of tables in the DHIS database which is used by all reporting and analysis tools to retrieve data from.":"","Analytics tables update":"","An unexpected error happened during maintenance":"","Skip generation of aggregate data and completeness data":"","Skip generation of resource tables":"","Skip generation of event data":"","Skip generation of enrollment data":"","Data Statistics":"","Browse the number of objects in the database, like data elements, indicators, data sets and data values.":"","Overview Data Statistics":"","Lock Exception Management":"","Lock Exception":"","Add or remove exceptions to the the standard rules for locking of data entry forms.":"","Min-Max Value Generation":"","Generate min-max values which can be used for data validation during data entry and validation processes.":"","Generate Min-Max Values":"","Number of last years of data to include":"","Start export":"","All":"","Checking data integrity...":"","Run integrity checks":"","{{issueTitle}} ({{issueElementsCount}})":"","Data elements without data set":"","Data elements without groups":"","Data elements violating exclusive group sets":"","Data elements assigned to data sets with different period types":"","Data sets not assigned to organisation units":"","Indicators with identical formulas":"","Indicators without groups":"","Invalid indicator numerators":"","Invalid indicator denominators":"","Indicators violating exclusive group sets":"","Organisation units with cyclic references":"","Orphaned organisation units":"","Organisation units without groups":"","Organisation units violating exclusive group sets":"","Organisation unit groups without group sets":"","Validation rules without groups":"","Invalid validation rule left side expressions":"","Invalid validation rule right side expressions":"","Invalid program indicator expressions":"","Invalid program indicator filters":"","There are data elements in the form, but not in the form or sections":"","Invalid category combinations":"","Duplicate periods":"","Program rules with no condition":"","Program rules with no action":"","Program rules with no priority":"","Program rule variables with no data element":"","Program rule variables with no attribute":"","Program rule actions with no data object":"","Program rule actions with no notification":"","Program rule actions with no section id":"","Program rule actions with no stage id":"","Program indicators with no expression":"","Indicators":"","Periods":"","Visualization":"","Events":"","Organisation units":"","Validation rules":"","Data values":"","Programs":"","Data elements":"","Organisation unit groups":"","Tracked entity instances":"","Pivot tables":"","Program instances":"","Indicator types":"","Data sets":"","User groups":"","Users":"","Maps":"","Indicator groups":"","Charts":"","Data element groups":"","Dashboards":"","Today":"","Last {{days}} days":"","Last hour":"","Object type":"","Users logged in":"","User account invitations":"","Pending invitations":"","Expired invitations":"","Error loading data statistics":"","No data statistics to show.":"","Period":"","Data set":"","Organisation unit":"","Organisation unit group":"","Organisation unit level":"","Select":"","Deselect":"","Select All Org Units":"","Deselect All Org Units":"","Name":"","Show details":"","Remove":"","Actions":"","week":"","month":"","year":"","bi monthly":"","day":"","jan":"","feb":"","mar":"","apr":"","may":"","jun":"","jul":"","aug":"","sep":"","oct":"","nov":"","dec":"","jan-feb":"","mar-apr":"","may-jun":"","jul-aug":"","sep-oct":"","nov-dec":"","quarter":"","Q1":"","Q2":"","Q3":"","Q4":"","six monthly":"","jan-jun":"","jul-dec":"","apr-sep":"","oct-mar":"","Error loading data for data set":"","Loading organisation units tree...":"","Select a data set":"","Lock exception added":"","Error adding lock exception: {{error}}":"","Add lock exception":"","Cancel":"","Adding lock exception...":"","Go back to all lock exceptions":"","Batch Deletion":"","Batch deletion":"","Error loading lock exceptions":"","No lock exceptions to show.":"","Batch delete lock exceptions":"","Remove lock exception":"","Lock exception removed":"","Error removing lock exception: {{error}}":"","Are you sure you want to remove this lock exception?":"","No, cancel":"","Removing lock exception...":"","Yes, remove lock exception":"","Maintenance done":"","Performing maintenance...":"","Error loading data":"","Generating min-max values...":"","Min-max values generated":"","Error generating min-max values":"","Removing min-max values...":"","Min-max values removed":"","Error removing min-max values":"","Generate min-max values":"","Remove min-max values":"","Generate tables":""}')},878:function(e){e.exports=JSON.parse('{"Data set":"Set de Datos\\\\:","Period":"Periodo","Organisation unit":"Unidad organizativa"}')},879:function(e){e.exports=JSON.parse('{"Data set":"Ensemble de donn\xe9es","Period":"P\xe9riode","Organisation unit":"Unit\xe9 d\'organisation"}')},880:function(e){e.exports=JSON.parse('{"Data set":"Data set","Period":"Periode","Organisation unit":"Unit organisasi"}')},881:function(e){e.exports=JSON.parse('{"Data set":"Data set","Period":"\u1780\u17c6\u17a1\u17bb\u1784\u1796\u17c1\u179b","Organisation unit":"\u1795\u17d2\u1793\u17c2\u1780\u200b\u1793\u17c3\u200b\u17a2\u1784\u17d2\u1782\u1780\u17b6\u179a"}')},882:function(e){e.exports=JSON.parse('{"Data set":"Data set\\\\:","Period":"\u0e8a\u0ec8\u0ea7\u0e87\u0ec0\u0ea7\u0ea5\u0eb2","Organisation unit":"\u200b\u0eab\u0ebb\u0ea7\u200b\u0edc\u0ec8\u0ea7\u0e8d\u200b\u0e81\u0eb2\u0e99\u200b\u0e88\u0eb1\u0e94\u200b\u0e95\u0eb1\u0ec9\u0e87"}')},883:function(e){e.exports=JSON.parse("{}")},884:function(e){e.exports=JSON.parse('{"Data set":"Dataset","Period":"\u1021\u1001\u103b\u102d\u1014\u103a\u1000\u102c\u101c","Organisation unit":"Organisation unit"}')},885:function(e){e.exports=JSON.parse('{"Data set":"Datasett","Period":"Periode","Organisation unit":"Organisasjonsenhet"}')},886:function(e){e.exports=JSON.parse("{}")},887:function(e){e.exports=JSON.parse('{"Data set":"\u062f \u0645\u0627\u0644\u0648\u0645\u0627\u062a\u0648 (\u0689\u0627\u067c\u0627) \u067c\u0648\u0644\u06ab\u0647","Period":"\u062f\u0648\u0631\u0647","Organisation unit":"\u0648\u0627\u062d\u062f \u0633\u0627\u0632\u0645\u0627\u0646"}')},888:function(e){e.exports=JSON.parse('{"Data set":"\u062f \u0645\u0627\u0644\u0648\u0645\u0627\u062a\u0648 (\u0689\u0627\u067c\u0627) \u067c\u0648\u0644\u06ab\u0647","Period":"\u0645\u0639\u06cc\u0627\u062f","Organisation unit":"\u062f \u0633\u0627\u0632\u0645\u0627\u0646 \u0648\u0627\u062d\u062f"}')},889:function(e){e.exports=JSON.parse('{"Data set":"Ficha","Period":"Per\xedodo","Organisation unit":"Unidade organizacional"}')},890:function(e){e.exports=JSON.parse('{"Data set":"Conjunto de dados","Period":"Per\xedodo","Organisation unit":"Unidade organizacional"}')},891:function(e){e.exports=JSON.parse('{"Data set":"\u041d\u0430\u0431\u043e\u0440 \u0434\u0430\u043d\u043d\u044b\u0445","Period":"\u041f\u0435\u0440\u0438\u043e\u0434","Organisation unit":"\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u043e\u043d\u043d\u0430\u044f \u0435\u0434\u0438\u043d\u0438\u0446\u0430"}')},892:function(e){e.exports=JSON.parse("{}")},893:function(e){e.exports=JSON.parse('{"Data set":"datam\xe4ngd","Period":"Period","Organisation unit":"Organisationsenhet"}')},894:function(e){e.exports=JSON.parse('{"Data set":"Pakote dadus","Period":"Per\xedodu","Organisation unit":"Unidade organizasional"}')},895:function(e){e.exports=JSON.parse('{"Data set":"\u041c\u0430\u04b7\u043c\u04ef\u0438 \u0438\u0442\u0442\u0438\u043b\u043e\u043e\u0442","Period":"\u0414\u0430\u0432\u0440\u0430","Organisation unit":"\u0412\u043e\u04b3\u0438\u0434\u0438 \u0441\u043e\u0445\u0442\u043e\u0440\u04e3"}')},896:function(e){e.exports=JSON.parse('{"Data set":"\u041d\u0430\u0431\u0456\u0440 \u0434\u0430\u043d\u0438\u0445","Period":"\u041f\u0435\u0440\u0456\u043e\u0434","Organisation unit":"\u041e\u0440\u0433\u0430\u043d\u0456\u0437\u0430\u0446\u0456\u0439\u043d\u0438\u0439 \u043f\u0456\u0434\u0440\u043e\u0437\u0434\u0456\u043b"}')},897:function(e){e.exports=JSON.parse('{"Data set":"\u0688\u06cc\u0679\u0627 \u0633\u06cc\u0679","Period":"\u0645\u062f\u062a","Organisation unit":"\u062a\u0646\u0638\u06cc\u0645 \u06cc\u0648\u0646\u0679"}')},898:function(e){e.exports=JSON.parse('{"Data set":"\u041c\u0430\u044a\u043b\u0443\u043c\u043e\u0442\u043b\u0430\u0440 \u0442\u045e\u043f\u043b\u0430\u043c\u0438","Period":"\u0414\u0430\u0432\u0440","Organisation unit":"\u0422\u0430\u0448\u043a\u0438\u043b\u0438\u0439 \u0431\u045e\u043b\u0438\u043c"}')},899:function(e){e.exports=JSON.parse('{"Data Administration":"\u041c\u0430\u044a\u043b\u0443\u043c\u043e\u0442\u043b\u0430\u0440\u043d\u0438 \u0431\u043e\u0448\u049b\u0430\u0440\u0438\u0448"}')},900:function(e){e.exports=JSON.parse('{"Data set":"Ma\u02bclumotlar to\u02bcplami","Period":"davr","Organisation unit":"\u0422\u0430\u0448\u043a\u0438\u043b\u0438\u0439 \u0431\u0438\u0440\u043b\u0438\u043a"}')},901:function(e){e.exports=JSON.parse('{"Data set":"T\u1eadp d\u1eef li\u1ec7u","Period":"Th\u1eddi \u0111i\u1ec3m","Organisation unit":"\u0110\u01a1n v\u1ecb"}')},902:function(e){e.exports=JSON.parse('{"Data set":"\u6570\u636e\u96c6","Period":"\u671f\u95f4","Organisation unit":"\u673a\u6784"}')},903:function(e){e.exports=JSON.parse('{"Data set":"\u6570\u636e\u96c6","Period":"\u5468\u671f","Organisation unit":"\u673a\u6784"}')},904:function(e,t,a){e.exports={header:"PageHeader_header__1jM0V",headerTitle:"PageHeader_headerTitle__1KEEp"}},905:function(e,t,a){e.exports={card:"Analytics_card__yDnHd",form:"Analytics_form__1kWco",checkboxes:"Analytics_checkboxes__3x3kH",noticeBox:"Analytics_noticeBox__33LKk",checkbox:"Analytics_checkbox__iwSjP",lastYearsSelect:"Analytics_lastYearsSelect__1u-Al"}},906:function(e,t,a){e.exports={card:"IssueCard_card__3_lBo",cardText:"IssueCard_cardText__2KnBC"}},907:function(e,t,a){e.exports={issues:"Issues_issues__24Dvb"}},908:function(e,t,a){e.exports={card:"DataStatistics_card__-usL2"}},972:function(e,t,a){e.exports={selectsContainer:"AddLockExceptionForm_selectsContainer__1FfO9",organisationUnitTree:"AddLockExceptionForm_organisationUnitTree__2Vu3S",right:"AddLockExceptionForm_right__3MHtt",organisationUnitSelectionCard:"AddLockExceptionForm_organisationUnitSelectionCard__13mBr"}},974:function(e,t,a){e.exports={pagination:"LockException_pagination__386cw",headerContainer:"LockException_headerContainer__3IVXu",header:"LockException_header__3DHeL",flexSpaceBetween:"LockException_flexSpaceBetween__1gFwr",lockExceptions:"LockException_lockExceptions__31sPL",lockExceptionsHeader:"LockException_lockExceptionsHeader__2K7Nm",lockExceptionDialog:"LockException_lockExceptionDialog__3Facz",marginForAddButton:"LockException_marginForAddButton__3L837",backArrowIcon:"LockException_backArrowIcon__3o-BP",headerDivider:"LockException_headerDivider__98yTN",subHeader:"LockException_subHeader__3h-v4"}},975:function(e,t,a){e.exports={card:"Maintenance_card__1RUV7",checkboxes:"Maintenance_checkboxes__2ABMP",checkbox:"Maintenance_checkbox__zRsfJ"}},976:function(e,t,a){e.exports={card:"MinMaxValueGeneration_card__3HhUq",header:"MinMaxValueGeneration_header__3aa-o",container:"MinMaxValueGeneration_container__1KXr1",label:"MinMaxValueGeneration_label__Zpg4R",left:"MinMaxValueGeneration_left___Z-17",right:"MinMaxValueGeneration_right__3Nvgn",tree:"MinMaxValueGeneration_tree__1LuaX",select:"MinMaxValueGeneration_select__3RB4a",options:"MinMaxValueGeneration_options__XH-P_"}},977:function(e,t,a){e.exports={card:"ResourceTables_card__1Xjck",description:"ResourceTables_description__3ojib",tableName:"ResourceTables_tableName__3eEPw",noticeBox:"ResourceTables_noticeBox__2-ZOw"}},978:function(e,t,a){e.exports={gridElement:"GridSection_gridElement__dFN30",gridTitleBar:"GridSection_gridTitleBar__iuWB9",gridTitleDescription:"GridSection_gridTitleDescription__OBU6O",gridIcon:"GridSection_gridIcon__1BcuZ",gridDescription:"GridSection_gridDescription__3BQ6R",gridActionText:"GridSection_gridActionText__2cTCc"}},984:function(e,t,a){e.exports={gridContainer:"Home_gridContainer__3mcNn"}},985:function(e,t,a){},986:function(e,t,a){e.exports={sidebarItem:"Sidebar_sidebarItem__3GXPY"}},990:function(e,t,a){"use strict";a.r(t);var n=a(440),i=a(7),s=a(564),r=a(0),o=a.n(r),l=a(354),c=a(641),d=a.n(c),p=a(274),u=a(5),h=a.n(u),m=a(6);const g={dataIntegrity:{title:m.a.t("Data Integrity"),label:m.a.t("Data Integrity"),description:m.a.t("Run data integrity checks and unveil anomalies and problems in the metadata setup."),actionText:m.a.t("Check data integrity"),unexpectedError:m.a.t("An unexpected error happened during data integrity checks")},maintenance:{title:m.a.t("Maintenance"),label:m.a.t("Maintenance"),description:m.a.t("Perform maintenance tasks and generate resource database tables for the organisation unit hierarchy and group set structure."),actionText:m.a.t("Perform maintenance"),checkboxes:{analyticsTableClear:m.a.t("Clear analytics tables"),analyticsTableAnalyze:m.a.t("Analyze analytics tables"),zeroDataValueRemoval:m.a.t("Remove zero data values"),softDeletedDataValueRemoval:m.a.t("Permanently remove soft deleted data values"),softDeletedEventRemoval:m.a.t("Permanently remove soft deleted events"),softDeletedEnrollmentRemoval:m.a.t("Permanently remove soft deleted enrollments"),softDeletedTrackedEntityInstanceRemoval:m.a.t("Permanently remove soft deleted tracked entity instances"),periodPruning:m.a.t("Prune periods"),expiredInvitationsClear:m.a.t("Remove expired invitations"),sqlViewsDrop:m.a.t("Drop SQL views"),sqlViewsCreate:m.a.t("Create SQL views"),categoryOptionComboUpdate:m.a.t("Update category option combinations"),ouPathsUpdate:m.a.t("Update organisation unit paths"),cacheClear:m.a.t("Clear application cache"),appReload:m.a.t("Reload apps")}},resourceTables:{title:m.a.t("Resource Tables"),label:m.a.t("Resource Tables"),description:m.a.t("Generate resource database tables for the organisation unit hierarchy and group set structure among others."),actionText:m.a.t("Generate Resource Tables"),unexpectedError:m.a.t("An unexpected error happened during operation"),tables:{organisationUnitStructure:m.a.t("Organisation unit structure"),organistionUnitCategoryOptionCombo:m.a.t("Organisation unit category option combo"),categoryOptionGroupSetStructure:m.a.t("Category option group set structure"),dataElementGroupSetStructure:m.a.t("Data element group set structure"),indicatorGroupSetStructure:m.a.t("Indicator group set structure"),organisationUnitGroupSetStructure:m.a.t("Organisation unit group set structure"),categoryStructure:m.a.t("Category structure"),dataElementCategoryOptionComboName:m.a.t("Data element category option combo name"),dataElementStructure:m.a.t("Data element structure"),periodStructure:m.a.t("Period structure"),dataPeriodStructure:m.a.t("Date period structure"),dataElementCategoryOptionCombinations:m.a.t("Data element category option combinations")}},analytics:{title:m.a.t("Analytics tables management"),label:m.a.t("Analytics Tables"),description:m.a.t("The data mart is a set of tables in the DHIS database which is used by all reporting and analysis tools to retrieve data from."),actionText:m.a.t("Analytics tables update"),unexpectedError:m.a.t("An unexpected error happened during maintenance"),checkboxes:{skipAggregate:m.a.t("Skip generation of aggregate data and completeness data"),skipResourceTables:m.a.t("Skip generation of resource tables"),skipEvents:m.a.t("Skip generation of event data"),skipEnrollment:m.a.t("Skip generation of enrollment data")}},dataStatistics:{title:m.a.t("Data Statistics"),label:m.a.t("Data Statistics"),description:m.a.t("Browse the number of objects in the database, like data elements, indicators, data sets and data values."),actionText:m.a.t("Overview Data Statistics")},lockException:{title:m.a.t("Lock Exception Management"),label:m.a.t("Lock Exception"),description:m.a.t("Add or remove exceptions to the the standard rules for locking of data entry forms."),actionText:m.a.t("Lock Exception Management")},minMaxValueGeneration:{title:m.a.t("Min-Max Value Generation"),label:m.a.t("Min-Max Value Generation"),description:m.a.t("Generate min-max values which can be used for data validation during data entry and validation processes."),actionText:m.a.t("Generate Min-Max Values")}};var y=a(310),b=a(1),k=a.n(b),E=a(393);const v="#8ac542",S="#000000",x="#ff0000",f="check",C={iconStyle:{fontSize:14},rowStyle:{fontSize:14,height:48},evenRowStyle:{backgroundColor:"#fafafa"},timeColumnStyle:{width:"20%"},messageColumnStyle:{width:"80%"},successStyle:{color:v,iconColor:v,fontWeight:"bold"},errorStyle:{color:x,iconColor:x,fontWeight:"bold"},infoStyle:{color:S,iconColor:v}},P={};P.SUCCESS={color:v,icon:f,row:Object.assign({},C.rowStyle,C.successStyle)},P.ERROR={color:x,icon:"error",row:Object.assign({},C.rowStyle,C.errorStyle)},P.INFO={color:S,icon:f,iconColor:v,row:Object.assign({},C.rowStyle,C.infoStyle)};const O=P;a(868);var w=({notifications:e,animateIncomplete:t})=>{const a=(e,a)=>{return o.a.createElement(E.e,{key:a,displayBorder:!1,style:Object.assign({},O[e.level].row,(a+1)%2===0?C.evenRowStyle:{})},o.a.createElement(E.f,{style:C.timeColumnStyle},(n=e.time)?"".concat(n.slice(0,10)," ").concat(n.slice(11,19)):""),o.a.createElement(E.f,{style:C.messageColumnStyle},e.message," ",(e=>{const a=O[e.level];return a&&a.icon&&e.completed?o.a.createElement(E.a,{className:"material-icons",style:C.iconStyle,color:a.iconColor},a.icon):t&&!e.completed?o.a.createElement("span",{className:"notification-icon-busy"},"..."):null})(e)));var n};return e&&e.length>0?o.a.createElement(E.c,{selectable:!1},o.a.createElement(E.d,{displayRowCheckbox:!1},e.map(a))):null},_=a(8),T=a(869),D=a(870),N=a(871),R=a(872),A=a(873),I=a(874),j=a(875),M=a(876),L=a(877),U=a(878),W=a(879),B=a(880),G=a(881),V=a(882),F=a(883),J=a(884),z=a(885),Y=a(886),q=a(887),K=a(888),Q=a(889),H=a(890),X=a(891),Z=a(892),$=a(893),ee=a(894),te=a(895),ae=a(896),ne=a(897),ie=a(898),se=a(899),re=a(900),oe=a(901),le=a(902),ce=a(903);const de="default";m.a.addResources("ar",de,T),m.a.addResources("ar_EG",de,D),m.a.addResources("ar_IQ",de,N),m.a.addResources("ar_SD",de,R),m.a.addResources("bn",de,A),m.a.addResources("ckb",de,I),m.a.addResources("cs",de,j),m.a.addResources("da",de,M),m.a.addResources("en",de,L),m.a.addResources("es",de,U),m.a.addResources("fr",de,W),m.a.addResources("id",de,B),m.a.addResources("km",de,G),m.a.addResources("lo",de,V),m.a.addResources("mn",de,F),m.a.addResources("my",de,J),m.a.addResources("nb",de,z),m.a.addResources("ne",de,Y),m.a.addResources("prs",de,q),m.a.addResources("ps",de,K),m.a.addResources("pt",de,Q),m.a.addResources("pt_BR",de,H),m.a.addResources("ru",de,X),m.a.addResources("rw",de,Z),m.a.addResources("sv",de,$),m.a.addResources("tet",de,ee),m.a.addResources("tg",de,te),m.a.addResources("uk",de,ae),m.a.addResources("ur",de,ne),m.a.addResources("uz",de,ie),m.a.addResources("uz_Cyrl",de,se),m.a.addResources("uz_Latn",de,re),m.a.addResources("vi",de,oe),m.a.addResources("zh",de,le),m.a.addResources("zh_CN",de,ce);var pe=m.a;var ue=({sectionKey:e})=>{const{serverVersion:t}=Object(_.d)(),a=(({major:e,minor:t,tag:a})=>"SNAPSHOT"===a?"master":"".concat(e).concat(t))(t),n=Sa(e);return o.a.createElement(E.b,{className:"helper-icon",iconStyle:{color:"#276696"},href:"https://docs.dhis2.org/en/use/user-guides/dhis-core-version-".concat(a,"/maintaining-the-system/data-administration.html#").concat(n),target:"_blank",rel:"noopener noreferrer",tooltip:pe.t("Open user guide"),tooltipPosition:"bottom-center",iconClassName:"material-icons"},"help")},he=a(904),me=a.n(he);var ge=({title:e,sectionKey:t})=>o.a.createElement("header",{className:me.a.header},o.a.createElement("h1",{className:me.a.headerTitle},e),o.a.createElement(ue,{sectionKey:t}));const ye="system/tasks/ANALYTICS_TABLE",be="-1",ke=[{key:be,value:be,displayName:m.a.t("All")}];for(let qa=1;qa<=10;qa++)ke.push({key:qa,value:String(qa),displayName:String(qa)});const Ee=ke,ve=["skipAggregate","skipResourceTables","skipEvents","skipEnrollment"].map((e=>({key:e,label:g.analytics.checkboxes[e]})));var Se=a(905),xe=a.n(Se);function fe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ce extends r.Component{constructor(){super(),fe(this,"startTaskProgressPolling",(()=>{this.intervalId=setInterval((()=>{this.requestTaskProgress()}),5e3)})),fe(this,"initAnalyticsTablesGeneration",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi(),t=this.buildFormData();this.setLoadingPageState();try{const{response:a}=await e.post("resourceTables/analytics",t);a&&this.setState({taskId:a.id},this.startTaskProgressPolling)}catch(a){this.setLoadedPageWithErrorState(a)}})),fe(this,"requestTaskSummary",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();try{const t=await e.get(ye),a=this.getActiveTaskIdFromSummary(t);a&&(this.setLoadingPageState(),this.setState({taskId:a,notifications:this.getUpdatedNotifications(t[a])},this.startTaskProgressPolling))}catch(t){this.setLoadedPageWithErrorState(t)}})),fe(this,"requestTaskProgress",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();try{const t=await e.get("".concat(ye,"/").concat(this.state.taskId));this.isTaskCompleted(t)&&(this.stopTaskProgressPolling(),this.unsetLoadingPageState()),this.setState({notifications:this.getUpdatedNotifications(t)})}catch(t){this.setLoadedPageWithErrorState(t)}})),fe(this,"handleLastYearsChange",(e=>{this.setState({lastYears:e})})),fe(this,"toggleCheckbox",(e=>{this.setState({checkboxes:{...this.state.checkboxes,[e]:!this.state.checkboxes[e]}})}));const e={};ve.forEach((t=>{e[t.key]=!1})),this.state={loading:!1,error:null,checkboxes:e,lastYears:be,taskId:null,notifications:[]},this.intervalId=null}componentWillUnmount(){this.stopTaskProgressPolling()}stopTaskProgressPolling(){clearInterval(this.intervalId),this.intervalId=null}setLoadingPageState(){this.setState({loading:!0,error:null,notifications:[]})}unsetLoadingPageState(){this.setState({loading:!1})}setLoadedPageWithErrorState(e){console.error(e);const t=e&&e.message?e.message:g.analytics.unexpectedError;this.stopTaskProgressPolling(),this.setState({error:t,loading:!1})}getUpdatedNotifications(e=[]){if(e.length<=this.state.notifications.length)return this.state.notifications;const t=e.length-1;return e.reverse().map(((e,a)=>({...e,completed:e.completed||a<t})))}getActiveTaskIdFromSummary(e){const{taskId:t}=Object.entries(e).reduce(((e,[t,a])=>{const n=a[a.length-1],i=new Date(n.time);return!this.isTaskCompleted(a)&&i>e.time?{taskId:t,time:i}:e}),{taskId:null,time:new Date(0)});return t}isTaskCompleted(e){return e[0].completed}buildFormData(){const e=new FormData;for(const[t,a]of Object.entries(this.state.checkboxes))e.append(t,a);return this.state.lastYears!==be&&e.append("lastYears",this.state.lastYears),e}render(){return o.a.createElement("div",null,o.a.createElement(ge,{sectionKey:this.props.sectionKey,title:g.analytics.title}),o.a.createElement(i.e,{className:xe.a.card},this.state.error&&o.a.createElement(i.t,{className:xe.a.noticeBox,error:!0},this.state.error),o.a.createElement("div",{className:xe.a.form},o.a.createElement("div",{className:xe.a.checkboxes},ve.map((e=>o.a.createElement(i.g,{key:e.key,className:xe.a.checkbox,label:e.label,checked:this.state.checkboxes[e.key],onChange:()=>this.toggleCheckbox(e.key),disabled:this.state.loading})))),o.a.createElement(i.w,{className:xe.a.lastYearsSelect,label:m.a.t("Number of last years of data to include"),selected:this.state.lastYears,onChange:({selected:e})=>this.handleLastYearsChange(e),disabled:this.state.loading},Ee.map((e=>o.a.createElement(i.x,{key:e.key,label:e.displayName,value:e.value}))))),o.a.createElement(i.c,{primary:!0,onClick:this.initAnalyticsTablesGeneration,disabled:this.state.loading},m.a.t("Start export"))),(this.state.notifications||[]).length>0&&o.a.createElement(i.e,{className:xe.a.card},o.a.createElement(w,{notifications:this.state.notifications,animateIncomplete:!0})))}}fe(Ce,"propTypes",{sectionKey:k.a.string.isRequired});var Pe=Ce,Oe=a(403),we=a(906),_e=a.n(we);const Te=({content:e})=>{const t=e=>Array.isArray(e)?e.join(", "):e;return Array.isArray(e)?e.map((e=>o.a.createElement("p",{key:e},t(e)))):Object.entries(e).map((([e,a])=>o.a.createElement("div",{key:e},o.a.createElement("h4",null,e),o.a.createElement("p",null,t(a)))))},De={titleStyle:{fontSize:16,fontWeight:"normal"}},Ne={titleColor:i.F.red600,openIcon:"keyboard_arrow_up",closeIcon:"keyboard_arrow_down",iconStyle:{}},Re={titleColor:i.F.green600,openIcon:"done",closeIcon:"done",iconStyle:{color:i.F.green600,cursor:"auto"}},Ae=({title:e,content:t})=>{const a=Array.isArray(t)?t.length:Object.keys(t).length,n=a>0,{titleColor:i,openIcon:s,closeIcon:r,iconStyle:l}=a>0?Ne:Re,c=o.a.createElement(E.a,{className:"material-icons"},s),d=o.a.createElement(E.a,{className:"material-icons"},r);return o.a.createElement(Oe.Card,{className:_e.a.card},o.a.createElement(Oe.CardHeader,{title:a>0?m.a.t("{{issueTitle}} ({{issueElementsCount}})",{issueTitle:e,issueElementsCount:a}):e,titleColor:i,titleStyle:De.titleStyle,actAsExpander:n,showExpandableButton:!0,closeIcon:d,openIcon:c,iconStyle:l}),a>0&&o.a.createElement(Oe.CardText,{className:_e.a.cardText,expandable:n},o.a.createElement(Te,{content:t})))};Ae.defaultProps={content:[]};var Ie=Ae,je=a(907),Me=a.n(je);const Le={dataElementsWithoutDataSet:m.a.t("Data elements without data set"),dataElementsWithoutGroups:m.a.t("Data elements without groups"),dataElementsViolatingExclusiveGroupSets:m.a.t("Data elements violating exclusive group sets"),dataElementsAssignedToDataSetsWithDifferentPeriodTypes:m.a.t("Data elements assigned to data sets with different period types"),dataSetsNotAssignedToOrganisationUnits:m.a.t("Data sets not assigned to organisation units"),indicatorsWithIdenticalFormulas:m.a.t("Indicators with identical formulas"),indicatorsWithoutGroups:m.a.t("Indicators without groups"),invalidIndicatorNumerators:m.a.t("Invalid indicator numerators"),invalidIndicatorDenominators:m.a.t("Invalid indicator denominators"),indicatorsViolatingExclusiveGroupSets:m.a.t("Indicators violating exclusive group sets"),organisationUnitsWithCyclicReferences:m.a.t("Organisation units with cyclic references"),orphanedOrganisationUnits:m.a.t("Orphaned organisation units"),organisationUnitsWithoutGroups:m.a.t("Organisation units without groups"),organisationUnitsViolatingExclusiveGroupSets:m.a.t("Organisation units violating exclusive group sets"),organisationUnitGroupsWithoutGroupSets:m.a.t("Organisation unit groups without group sets"),validationRulesWithoutGroups:m.a.t("Validation rules without groups"),invalidValidationRuleLeftSideExpressions:m.a.t("Invalid validation rule left side expressions"),invalidValidationRuleRightSideExpressions:m.a.t("Invalid validation rule right side expressions"),invalidProgramIndicatorExpressions:m.a.t("Invalid program indicator expressions"),invalidProgramIndicatorFilters:m.a.t("Invalid program indicator filters"),dataElementsInDataSetNotInForm:m.a.t("There are data elements in the form, but not in the form or sections"),invalidCategoryCombos:m.a.t("Invalid category combinations"),duplicatePeriods:m.a.t("Duplicate periods"),programRulesWithNoCondition:m.a.t("Program rules with no condition"),programRulesWithNoAction:m.a.t("Program rules with no action"),programRulesWithNoPriority:m.a.t("Program rules with no priority"),programRuleVariablesWithNoDataElement:m.a.t("Program rule variables with no data element"),programRuleVariablesWithNoAttribute:m.a.t("Program rule variables with no attribute"),programRuleActionsWithNoDataObject:m.a.t("Program rule actions with no data object"),programRuleActionsWithNoNotification:m.a.t("Program rule actions with no notification"),programRuleActionsWithNoSectionId:m.a.t("Program rule actions with no section id"),programRuleActionsWithNoStageId:m.a.t("Program rule actions with no stage id"),programIndicatorsWithNoExpression:m.a.t("Program indicators with no expression")};var Ue=({issues:e})=>{const t=Object.keys(e);return o.a.createElement("div",{className:Me.a.issues},t.map((t=>{const a=Le[t];return a?o.a.createElement(Ie,{key:t,title:a,content:e[t]}):null})),Object.keys(Le).filter((e=>!t.includes(e))).map((e=>o.a.createElement(Ie,{key:e,title:Le[e]}))))};const We={resource:"dataIntegrity",type:"create"},Be={poll:{resource:"system/taskSummaries/DATA_INTEGRITY",id:({jobId:e})=>e}},Ge=()=>{const{refetch:e,error:t,data:a}=Object(_.f)(Be,{lazy:!0}),n=((e,t)=>{const a=Object(r.useRef)(null),n=()=>{a.current&&clearInterval(a.current)};return Object(r.useEffect)((()=>n),[]),{start:(...n)=>{a.current=setInterval((()=>e(...n)),t)},cancel:n}})((t=>{e({jobId:t})}),3e3);return Object(r.useEffect)((()=>{null!==a&&void 0!==a&&a.poll&&n.cancel()}),[a]),{...n,error:t,data:null===a||void 0===a?void 0:a.poll}};var Ve=({sectionKey:e})=>{var t;const[a,{loading:n,error:s,data:l}]=Object(_.e)(We),c=Ge(),d=l&&!c.data;return Object(r.useEffect)((()=>{if(n||!l)return;const{id:e}=l.response;c.start(e)}),[n,l]),o.a.createElement(o.a.Fragment,null,o.a.createElement(ge,{sectionKey:e,title:g.dataIntegrity.title}),(s||c.error)&&o.a.createElement(i.t,{error:!0},(null===s||void 0===s?void 0:s.message)||(null===(t=c.error)||void 0===t?void 0:t.message)),c.data&&o.a.createElement(Ue,{issues:c.data}),o.a.createElement(i.c,{primary:!0,disabled:n||d,onClick:a},n||d?o.a.createElement(o.a.Fragment,null,m.a.t("Checking data integrity..."),o.a.createElement(i.h,{small:!0})):m.a.t("Run integrity checks")))},Fe=a(908),Je=a.n(Fe);var ze=e=>o.a.createElement("span",null,new Intl.NumberFormat(m.a.language).format(e.value));var Ye=({elements:e,label:t})=>o.a.createElement(i.y,{suppressZebraStriping:!0},o.a.createElement(i.C,null,o.a.createElement(i.E,null,o.a.createElement(i.B,null,t),o.a.createElement(i.B,null))),o.a.createElement(i.z,null,e.map((e=>o.a.createElement(i.D,{key:e.label},o.a.createElement(i.A,null,e.label),o.a.createElement(i.A,null,o.a.createElement(ze,{value:e.count})))))));function qe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Ke="objectCounts",Qe="activeUsers",He="userInvitations",Xe="dataValueCount",Ze="eventCount",$e="expired",et={indicator:m.a.t("Indicators"),period:m.a.t("Periods"),visualization:m.a.t("Visualization"),programStageInstance:m.a.t("Events"),organisationUnit:m.a.t("Organisation units"),validationRule:m.a.t("Validation rules"),dataValue:m.a.t("Data values"),program:m.a.t("Programs"),dataElement:m.a.t("Data elements"),organisationUnitGroup:m.a.t("Organisation unit groups"),trackedEntityInstance:m.a.t("Tracked entity instances"),reportTable:m.a.t("Pivot tables"),programInstance:m.a.t("Program instances"),indicatorType:m.a.t("Indicator types"),dataSet:m.a.t("Data sets"),userGroup:m.a.t("User groups"),user:m.a.t("Users"),map:m.a.t("Maps"),indicatorGroup:m.a.t("Indicator groups"),chart:m.a.t("Charts"),dataElementGroup:m.a.t("Data element groups"),dashboard:m.a.t("Dashboards")},tt=({label:e,elements:t})=>o.a.createElement(i.e,{className:Je.a.card},o.a.createElement(Ye,{label:e,elements:t})),at=e=>{const t=parseInt(e,10);return 1===t?m.a.t("Today"):t>0?m.a.t("Last {{days}} days",{days:t}):m.a.t("Last hour")},nt=e=>{if(!e)return null;const t={label:m.a.t("User account invitations"),elements:[]};return Object.hasOwnProperty.call(e,"all")&&t.elements.push({label:m.a.t("Pending invitations"),count:e.all}),Object.hasOwnProperty.call(e,$e)&&t.elements.push({label:m.a.t("Expired invitations"),count:e.expired}),t};class it extends r.Component{constructor(...e){super(...e),qe(this,"state",{loading:!0,error:null,tables:null}),qe(this,"loadDataStatistics",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();try{const s=await e.get("dataSummary"),r={[Ke]:(i=s.objectCounts,i?{label:m.a.t("Object type"),elements:Object.entries(i).map((([e,t])=>({label:et[e]||e,count:t})))}:null),[Qe]:(n=s.activeUsers,n?{label:m.a.t("Users logged in"),elements:Object.entries(n).map((([e,t])=>({label:at(e),count:t})))}:null),[He]:nt(s.userInvitations),[Xe]:(a=s.dataValueCount,a?{label:m.a.t("Data values"),elements:Object.entries(a).map((([e,t])=>({label:at(e),count:t})))}:null),[Ze]:(t=s.eventCount,t?{label:m.a.t("Events"),elements:Object.entries(t).map((([e,t])=>({label:at(e),count:t})))}:null)};this.setState({loading:!1,tables:r})}catch(s){this.setState({loading:!1,error:s.message||m.a.t("Error loading data statistics")})}var t,a,n,i}))}componentDidMount(){this.loadDataStatistics()}renderTable(e){return this.state.tables[e]?o.a.createElement(tt,{key:e,label:this.state.tables[e].label,elements:this.state.tables[e].elements}):null}renderTables(){return 0===Object.keys(this.state.tables).length?o.a.createElement("em",null,m.a.t("No data statistics to show.")):o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},this.renderTable(Ke)),o.a.createElement("div",{className:"col-md-6"},this.renderTable(He),this.renderTable(Xe),this.renderTable(Ze),this.renderTable(Qe)))}render(){return o.a.createElement("div",null,o.a.createElement(ge,{sectionKey:this.props.sectionKey,title:g.dataStatistics.title}),this.state.error?o.a.createElement(i.t,{error:!0},this.state.error):this.state.loading?o.a.createElement(i.f,null,o.a.createElement(i.h,null)):this.renderTables())}}qe(it,"propTypes",{sectionKey:k.a.string.isRequired});var st=it,rt=a(300),ot=a.n(rt),lt=a(294),ct=a.n(lt),dt=a(328),pt=a.n(dt),ut=a(909),ht=a(910),mt=a(911),gt=a(988),yt=a(972),bt=a.n(yt),kt=a(417),Et=a.n(kt);class vt extends o.a.Component{constructor(e){var t,a,n;super(e),n=e=>{this.props.onClick&&this.props.onClick(e),void 0!==e&&e.stopPropagation()},(a="handleClick")in(t=this)?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,this.state={collapsed:!e.initiallyExpanded,hasBeenExpanded:e.initiallyExpanded}}toggleCollapsed(){this.setState((e=>({collapsed:!e.collapsed,hasBeenExpanded:!0})),(()=>{this.state.collapsed||"function"!==typeof this.props.onExpand||this.props.onExpand()}))}UNSAFE_componentWillReceiveProps(e){e.initiallyExpanded&&this.state.collapsed&&this.toggleCollapsed()}render(){const e={tree:{marginLeft:16,whiteSpace:"nowrap"},itemLabel:{display:"inline-block",position:"relative"},arrow:{display:"inline-block",position:"absolute",left:-16,top:-1,width:11,height:16,paddingLeft:4,textAlign:"center",cursor:"pointer"},arrowSymbol:{transition:"transform 150ms ease-out",transform:this.state.collapsed?"":"rotate(90deg)",position:"absolute"},clickTarget:{cursor:this.props.onClick&&"pointer"},children:{position:"relative",marginLeft:16,height:this.state.collapsed?0:"inherit"}},t=o.a.createElement("div",{style:e.itemLabel},o.a.createElement("div",{className:"arrow",style:e.arrow,onClick:this.toggleCollapsed.bind(this)},o.a.createElement("div",{style:e.arrowSymbol},this.props.arrowSymbol)),o.a.createElement("div",{className:"label",onClick:this.handleClick,style:e.clickTarget},this.props.label));e.children.display=this.state.collapsed?"none":"block";const a=(!this.state.collapsed||this.props.persistent&&this.state.hasBeenExpanded)&&o.a.createElement("div",{className:"children",style:e.children},this.props.children),n="tree-view ".concat(this.props.className);return o.a.createElement("div",{className:n,style:Object.assign(e.tree,this.props.style)},t,a)}}vt.defaultProps={persistent:!1,initiallyExpanded:!1,arrowSymbol:"\u25b8",style:{}};var St=vt;const xt={progress:{position:"absolute",display:"inline-block",width:"100%",left:-8},progressBar:{height:2,backgroundColor:"transparent"},spacer:{position:"relative",display:"inline-block",width:"1.2rem",height:"1rem"},label:{display:"inline-block",outline:"none"},ouContainer:{borderColor:"transparent",borderStyle:"solid",borderWidth:"1px",borderRightWidth:0,borderRadius:"3px 0 0 3px",background:"transparent",paddingLeft:2,outline:"none"},currentOuContainer:{background:"rgba(0,0,0,0.05)",borderColor:"rgba(0,0,0,0.1)"},memberCount:{fontSize:"0.75rem",marginLeft:4}};class ft extends o.a.Component{constructor(e){super(e),this.state={children:!1===e.root.children||Array.isArray(e.root.children)&&0===e.root.children.length?[]:void 0,loading:!1},"toArray"in e.root.children&&!e.root.children.hasUnloadedData&&(this.state.children=e.root.children.toArray().sort(((e,t)=>e.displayName.localeCompare(t.displayName)))),this.loadChildren=this.loadChildren.bind(this),this.handleSelectClick=this.handleSelectClick.bind(this)}componentDidMount(){this.props.initiallyExpanded.some((e=>e.includes("/".concat(this.props.root.id))))&&this.loadChildren()}UNSAFE_componentWillReceiveProps(e){(e.initiallyExpanded.some((t=>t.includes("/".concat(e.root.id))))||e.idsThatShouldBeReloaded.includes(e.root.id))&&this.loadChildren()}setChildState(e){this.props.onChildrenLoaded&&this.props.onChildrenLoaded(e),this.setState({children:e.toArray().sort(((e,t)=>e.displayName.localeCompare(t.displayName))),loading:!1})}loadChildren(){if(void 0===this.state.children&&!this.state.loading||this.props.idsThatShouldBeReloaded.indexOf(this.props.root.id)>=0){this.setState({loading:!0});this.props.root.children.load({fields:"id,displayName,children::isNotEmpty,path,parent"},this.props.forceReloadChildren).then((e=>{this.setChildState(e)}))}}handleSelectClick(e){this.props.onSelectClick&&this.props.onSelectClick(e,this.props.root),e.stopPropagation()}shouldIncludeOrgUnit(e){return!this.props.orgUnitsPathsToInclude||0===this.props.orgUnitsPathsToInclude.length||!!this.props.orgUnitsPathsToInclude.some((t=>t.includes("/".concat(e.id))))}renderChild(e,t){return this.shouldIncludeOrgUnit(e)?o.a.createElement(ft,{key:e.id,root:e,selected:this.props.selected,initiallyExpanded:t,onSelectClick:this.props.onSelectClick,currentRoot:this.props.currentRoot,onChangeCurrentRoot:this.props.onChangeCurrentRoot,labelStyle:this.props.labelStyle,selectedLabelStyle:this.props.selectedLabelStyle,arrowSymbol:this.props.arrowSymbol,idsThatShouldBeReloaded:this.props.idsThatShouldBeReloaded,hideCheckboxes:this.props.hideCheckboxes,onChildrenLoaded:this.props.onChildrenLoaded,hideMemberCount:this.props.hideMemberCount,orgUnitsPathsToInclude:this.props.orgUnitsPathsToInclude,forceReloadChildren:this.props.forceReloadChildren}):null}renderChildren(){const e=Array.isArray(this.props.initiallyExpanded)?this.props.initiallyExpanded.filter((e=>e!==this.props.root.id)):this.props.initiallyExpanded!==this.props.root.id&&this.props.initiallyExpanded||[];return Array.isArray(this.state.children)&&this.state.children.length>0?this.state.children.map((t=>this.renderChild(t,e))):this.state.loading?o.a.createElement("div",{style:xt.progress},o.a.createElement(Et.a,{style:xt.progressBar})):null}render(){const e=this.props.root,t=void 0===this.state.children||Array.isArray(this.state.children)&&this.state.children.length>0,a=!!this.props.onSelectClick,n=new RegExp("/".concat(e.id,"$")),i=new RegExp("/".concat(e.id)),s=this.props.selected&&this.props.selected.some((e=>n.test(e))),r=this.props.currentRoot&&this.props.currentRoot.id===e.id,l=this.props.initiallyExpanded.some((t=>t.includes("/".concat(e.id)))),c=this.props.onChangeCurrentRoot&&!r&&t,d=void 0!==this.props.selected?this.props.selected.filter((e=>i.test(e))).length:e.memberCount,p=Object.assign({},xt.label,{fontWeight:s?500:300,color:s?"orange":"inherit",cursor:c?"pointer":"default"},s?this.props.selectedLabelStyle:this.props.labelStyle),u=Object.assign({},xt.ouContainer,r?xt.currentOuContainer:{}),h=o.a.createElement("div",{style:p,onClick:c&&(t=>{t.stopPropagation(),this.props.onChangeCurrentRoot(e)})||a&&this.handleSelectClick,role:"button",tabIndex:0},a&&!this.props.hideCheckboxes&&o.a.createElement("input",{type:"checkbox",readOnly:!0,disabled:!a,checked:s,onClick:this.handleSelectClick}),e.displayName,t&&!this.props.hideMemberCount&&!!d&&o.a.createElement("span",{style:xt.memberCount},"(",d,")"));return t?o.a.createElement(St,{label:h,onExpand:this.loadChildren,persistent:!0,initiallyExpanded:l,arrowSymbol:this.props.arrowSymbol,className:"orgunit with-children",style:u},this.renderChildren()):o.a.createElement("div",{onClick:a&&this.handleSelectClick,className:"orgunit without-children",style:u,role:"button",tabIndex:0},o.a.createElement("div",{style:xt.spacer}),h)}}ft.defaultProps={selected:[],initiallyExpanded:[],onSelectClick:void 0,onChangeCurrentRoot:void 0,currentRoot:void 0,onChildrenLoaded:void 0,labelStyle:{},selectedLabelStyle:{},idsThatShouldBeReloaded:[],arrowSymbol:void 0,hideCheckboxes:!1,hideMemberCount:!1,orgUnitsPathsToInclude:null,forceReloadChildren:!1};var Ct=ft,Pt=a(973),Ot=a(411),wt=a.n(Ot),_t=a(301),Tt=a.n(_t),Dt=a(329),Nt=a.n(Dt);const Rt={datePicker:{width:"100%"},year:{width:95,marginRight:16},month:{width:125},week:{width:105},biWeek:{width:200},biMonth:{width:200},quarter:{width:200},sixMonth:{width:200},line:{marginTop:0}},At=e=>new Date(e).getFullYear().toString(),It=e=>{const t=new Date(e).getMonth()+1;return"0".concat(t).slice(-2)},jt=e=>"".concat(At(e)).concat(It(e)).concat((e=>{const t=new Date(e).getDate();return"0".concat(t).slice(-2)})(e)),Mt=e=>{const t=new Date(e);return t.setDate(t.getDate()-(e.getDay()+6)%7+3),t.getFullYear()},Lt=(e,t)=>!Object(Pt.is53WeekISOYear)(e)&&53!==Number(t),Ut=e=>2*parseInt(e)-1;class Wt extends o.a.Component{constructor(e,t){super(e,t),this.state={}}getTranslation(e){return this.props.d2.i18n.getTranslation(e)}componentDidUpdate(e){this.props.periodType!==e.periodType&&this.handleChange()}getPeriod(){const e="BiWeekly"===this.props.periodType&&this.state.biWeek?Ut(this.state.biWeek):this.state.week,t=this.state.year&&e&&Object(Pt.getFirstDateOfWeek)(this.state.year,e);switch(this.props.periodType){case"Daily":return this.state.date&&jt(this.state.date);case"Weekly":return t&&this.setState({invalidWeek:!Lt(t,this.state.week)}),t&&Lt(t,this.state.week)&&"".concat(Mt(t),"W").concat(this.state.week);case"WeeklyWednesday":return t&&this.setState({invalidWeek:!Lt(t,this.state.week)}),t&&Lt(t,this.state.week)&&"".concat(Mt(t),"WedW").concat(this.state.week);case"WeeklyThursday":return t&&this.setState({invalidWeek:!Lt(t,this.state.week)}),t&&Lt(t,this.state.week)&&"".concat(Mt(t),"ThuW").concat(this.state.week);case"WeeklySaturday":return t&&this.setState({invalidWeek:!Lt(t,this.state.week)}),t&&Lt(t,this.state.week)&&"".concat(Mt(t),"SatW").concat(this.state.week);case"WeeklySunday":return t&&this.setState({invalidWeek:!Lt(t,this.state.week)}),t&&Lt(t,this.state.week)&&"".concat(Mt(t),"SunW").concat(this.state.week);case"BiWeekly":return t&&this.setState({invalidBiWeek:!Lt(t,Ut(this.state.biWeek))}),this.state.year&&this.state.biWeek&&"".concat(this.state.year,"BiW").concat(this.state.biWeek);case"Monthly":return this.state.year&&this.state.month&&"".concat(this.state.year).concat(this.state.month);case"BiMonthly":return this.state.year&&this.state.biMonth&&"".concat(this.state.year,"0").concat(this.state.biMonth,"B");case"Quarterly":return this.state.year&&this.state.quarter&&"".concat(this.state.year,"Q").concat(this.state.quarter);case"SixMonthly":return this.state.year&&this.state.sixMonth&&"".concat(this.state.year,"S").concat(this.state.sixMonth);case"SixMonthlyApril":return this.state.year&&this.state.sixMonth&&"".concat(this.state.year,"AprilS").concat(this.state.sixMonth);case"SixMonthlyNov":return this.state.year&&this.state.sixMonth&&"".concat(this.state.year,"NovS").concat(this.state.sixMonth);case"Yearly":return this.state.year;case"FinancialApril":return this.state.year&&"".concat(this.state.year,"April");case"FinancialJuly":return this.state.year&&"".concat(this.state.year,"July");case"FinancialOct":return this.state.year&&"".concat(this.state.year,"Oct");default:return!1}}handleChange(){this.getPeriod()&&this.props.onPickPeriod(this.getPeriod())}renderOptionPicker(e,t){const a="week"===e&&this.state.invalidWeek||"biWeek"===e&&this.state.invalidBiWeek;return o.a.createElement("div",{style:{display:"inline-block"},"data-test":"period-picker-option-".concat(e)},o.a.createElement(Nt.a,{value:this.state[e],onChange:(t,a,n)=>this.setState({[e]:n},this.handleChange),style:Rt[e],floatingLabelText:this.getTranslation(e),floatingLabelStyle:a?{color:"red"}:{}},Object.keys(t).sort().map((a=>o.a.createElement(Tt.a,{key:a,value:a,primaryText:/[^0-9]/.test(t[a])&&"biWeek"!==e?this.getTranslation(t[a]):t[a]})))))}renderYearPicker(){const e={},t=(new Date).getFullYear();for(let a=2014;a<t+5;a++)e[a]=a;return this.renderOptionPicker("year",e)}renderMonthPicker(){return this.renderOptionPicker("month",{"01":"jan","02":"feb","03":"mar","04":"apr","05":"may","06":"jun","07":"jul","08":"aug","09":"sep",10:"oct",11:"nov",12:"dec"})}renderWeekPicker(){const e={};for(let t=1;t<=53;t++)e["0".concat(t).substr(-2)]=t;return this.renderOptionPicker("week",e)}renderBiWeekPicker(){const e={},t=this.getTranslation("bi_week");for(let a=1;a<=27;a++)e["0".concat(a).substr(-2)]="".concat(t," ").concat(a);return this.renderOptionPicker("biWeek",e)}renderBiMonthPicker(){return this.renderOptionPicker("biMonth",{1:"jan-feb",2:"mar-apr",3:"may-jun",4:"jul-aug",5:"sep-oct",6:"nov-dec"})}renderQuarterPicker(){return this.renderOptionPicker("quarter",{1:"Q1",2:"Q2",3:"Q3",4:"Q4"})}render(){const e=(e,t)=>{const a=At(t),n=It(t);this.setState({date:t,year:a,month:n},this.handleChange)};switch(this.props.periodType){case"Daily":return o.a.createElement(wt.a,{floatingLabelText:this.getTranslation("day"),onChange:e,autoOk:!0,container:"inline",style:Rt.datePicker});case"Weekly":case"WeeklyWednesday":case"WeeklyThursday":case"WeeklySaturday":case"WeeklySunday":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderWeekPicker());case"BiWeekly":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderBiWeekPicker());case"Monthly":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderMonthPicker());case"BiMonthly":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderBiMonthPicker());case"Quarterly":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderQuarterPicker());case"SixMonthly":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderOptionPicker("sixMonth",{1:"jan-jun",2:"jul-dec"}));case"SixMonthlyApril":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderOptionPicker("sixMonth",{1:"apr-sep",2:"oct-mar"}));case"SixMonthlyNov":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker(),this.renderOptionPicker("sixMonth",{1:"nov-apr",2:"may-oct"}));case"Yearly":case"FinancialApril":case"FinancialJuly":case"FinancialOct":return o.a.createElement("div",{style:Rt.line},this.renderYearPicker());default:return null}}}var Bt=Wt;function Gt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Vt={minWidth:360,marginRight:20};class Ft extends r.Component{constructor(e){super(e),Gt(this,"handleDataSetChange",(async e=>{const t=e.id;if(null!==this.state.dataSet&&t===this.state.dataSet.id)return;this.props.updateSelectedDataSetId(t),this.setState({rootWithMembers:null,selected:[],dataSet:e});const{d2:a}=this.props;try{const[e,n]=await Promise.all([a.models.organisationUnits.list({paging:!1,level:1,fields:"id,displayName,path,children::isNotEmpty,memberCount",memberCollection:"dataSets",memberObject:t}),a.models.dataSets.get(t,{paging:!1,fields:"organisationUnits[id,path]"})]),i=e.toArray()[0];this.setState({rootWithMembers:i,selected:[],orgUnitPaths:n.organisationUnits.toArray().map((e=>e.path))})}catch(n){this.setState({error:m.a.t("Error loading data for data set")})}})),Gt(this,"handlePeriodChange",(e=>{this.props.updateSelectedPeriodId(e)})),Gt(this,"handleSelectionUpdate",(e=>{this.setState({selected:e}),this.props.updateSelectedOrgUnits(this.state.selected)})),Gt(this,"handleOrgUnitClick",((e,t)=>{if(this.state.selected.includes(t.path)){const e=this.state.selected;e.splice(e.indexOf(t.path),1),this.setState({selected:e})}else{const e=this.state.selected;e.push(t.path),this.setState({selected:e})}this.props.updateSelectedOrgUnits(this.state.selected)})),Gt(this,"handleChangeRoot",(e=>{this.setState({currentRoot:e})})),this.state={selected:[],dataSet:null,orgUnitPaths:null,error:null},this.fixD2Translations()}getChildContext(){return{d2:this.props.d2}}fixD2Translations(){Object.assign(this.props.d2.i18n.translations,{period:m.a.t("Period"),data_set:m.a.t("Data set"),organisation_unit:m.a.t("Organisation unit"),organisation_unit_group:m.a.t("Organisation unit group"),organisation_unit_level:m.a.t("Organisation unit level"),select:m.a.t("Select"),deselect:m.a.t("Deselect"),select_all:m.a.t("Select All Org Units"),deselect_all:m.a.t("Deselect All Org Units"),name:m.a.t("Name"),show:m.a.t("Show details"),remove:m.a.t("Remove"),actions:m.a.t("Actions"),week:m.a.t("week"),month:m.a.t("month"),year:m.a.t("year"),biMonth:m.a.t("bi monthly"),day:m.a.t("day"),jan:m.a.t("jan"),feb:m.a.t("feb"),mar:m.a.t("mar"),apr:m.a.t("apr"),may:m.a.t("may"),jun:m.a.t("jun"),jul:m.a.t("jul"),aug:m.a.t("aug"),sep:m.a.t("sep"),oct:m.a.t("oct"),nov:m.a.t("nov"),dec:m.a.t("dec"),"jan-feb":m.a.t("jan-feb"),"mar-apr":m.a.t("mar-apr"),"may-jun":m.a.t("may-jun"),"jul-aug":m.a.t("jul-aug"),"sep-oct":m.a.t("sep-oct"),"nov-dec":m.a.t("nov-dec"),quarter:m.a.t("quarter"),Q1:m.a.t("Q1"),Q2:m.a.t("Q2"),Q3:m.a.t("Q3"),Q4:m.a.t("Q4"),sixMonth:m.a.t("six monthly"),"jan-jun":m.a.t("jan-jun"),"jul-dec":m.a.t("jul-dec"),"apr-sep":m.a.t("apr-sep"),"oct-mar":m.a.t("oct-mar")})}renderOrganisationUnitSelectionCard(){return o.a.createElement("div",{className:bt.a.organisationUnitSelectionCard},o.a.createElement("div",{className:bt.a.organisationUnitTree,"data-test":"add-lock-exception-modal-org-unit-tree"},this.state.rootWithMembers?o.a.createElement(Ct,{root:this.state.rootWithMembers,selected:this.state.selected,currentRoot:this.state.currentRoot,initiallyExpanded:["/".concat(this.state.rootWithMembers.id)],memberCollection:"dataSets",memberObject:this.state.dataSet.id,onSelectClick:this.handleOrgUnitClick,onChangeCurrentRoot:this.handleChangeRoot,orgUnitsPathsToInclude:this.state.orgUnitPaths}):m.a.t("Loading organisation units tree...")),o.a.createElement("div",{className:bt.a.right},o.a.createElement("div",null,o.a.createElement("div",null,this.state.currentRoot?m.a.t("For organisation units within {{organisationUnitName}}:",{organisationUnitName:this.state.currentRoot.displayName}):m.a.t("For all organisation units:")),o.a.createElement(mt.a,{levels:this.props.levels,selected:this.state.selected,currentRoot:this.state.currentRoot,onUpdateSelection:this.handleSelectionUpdate}),o.a.createElement(ht.a,{groups:this.props.groups,selected:this.state.selected,currentRoot:this.state.currentRoot,onUpdateSelection:this.handleSelectionUpdate}),o.a.createElement(ut.a,{selected:this.state.selected,currentRoot:this.state.currentRoot,onUpdateSelection:this.handleSelectionUpdate}))))}render(){const e=this.props.dataSets.map((e=>{var t;return{id:e.id,name:e.displayName,periodType:null===(t=e.periodType)||void 0===t?void 0:t.name}}));let t=m.a.t("Select a data set"),a=null;return this.state.dataSet&&(t=m.a.t("Data set"),a=this.state.dataSet.id),o.a.createElement("div",null,o.a.createElement("div",{className:bt.a.selectsContainer},o.a.createElement("div",{"data-test":"add-lock-exception-modal-select-data-set"},o.a.createElement(gt.a,{style:Vt,label:t,items:e,onChange:this.handleDataSetChange,value:a})),this.state.dataSet&&o.a.createElement("div",null,o.a.createElement(Bt,{d2:this.props.d2,periodType:this.state.dataSet.periodType,onPickPeriod:this.handlePeriodChange}))),this.state.dataSet&&(this.state.error?o.a.createElement(i.t,{error:!0},this.state.error):this.renderOrganisationUnitSelectionCard()))}}Gt(Ft,"propTypes",{d2:k.a.object.isRequired,dataSets:k.a.array.isRequired,groups:k.a.oneOfType([k.a.object,k.a.array]).isRequired,levels:k.a.oneOfType([k.a.object,k.a.array]).isRequired,updateSelectedDataSetId:k.a.func.isRequired,updateSelectedOrgUnits:k.a.func.isRequired,updateSelectedPeriodId:k.a.func.isRequired}),Gt(Ft,"childContextTypes",{d2:k.a.object});var Jt=Ft;var zt=({levels:e,groups:t,dataSets:a,onAdd:s,onClose:l})=>{const c=Object(_.b)(m.a.t("Lock exception added"),{success:!0}),d=Object(_.b)((({error:e})=>m.a.t("Error adding lock exception: {{error}}",{error:e,nsSeparator:null})),{critical:!0}),[p,u]=Object(r.useState)(!1),[h,g]=Object(r.useState)([]),[y,b]=Object(r.useState)(null),[k,E]=Object(r.useState)(null),{d2:v}=Object(n.a)(),S=p||!(h.length>0&&y&&k);return o.a.createElement(pt.a,{title:m.a.t("Add lock exception"),actions:o.a.createElement("div",{"data-test":"add-lock-exception-modal-actions"},o.a.createElement(i.d,{end:!0},o.a.createElement(i.c,{disabled:p,onClick:l},m.a.t("Cancel")),o.a.createElement(i.c,{primary:!0,disabled:S,onClick:async()=>{u(!0);try{await s({selectedOrgUnits:h,selectedDataSetId:y,selectedPeriodId:k}),c.show(),l()}catch(e){d.show({error:e})}u(!1)}},p?o.a.createElement(o.a.Fragment,null,m.a.t("Adding lock exception..."),o.a.createElement(i.h,{small:!0})):m.a.t("Add lock exception")))),open:!0,contentStyle:{maxWidth:"80%"},bodyStyle:{overflowY:"scroll"},onRequestClose:l},o.a.createElement("div",{"data-test":"add-lock-exception-modal"},o.a.createElement(Jt,{d2:v,levels:e,groups:t,dataSets:a,updateSelectedOrgUnits:g,updateSelectedDataSetId:b,updateSelectedPeriodId:E})))},Yt=a(974),qt=a.n(Yt);const Kt={dataSet:m.a.t("Data set"),period:m.a.t("Period"),organisationUnit:m.a.t("Organisation unit")};var Qt=({columns:e,rows:t,atBatchDeletionPage:a,onRemoveLockException:n})=>o.a.createElement(i.y,null,o.a.createElement(i.C,null,o.a.createElement(i.E,null,e.map((e=>o.a.createElement(i.B,{key:e},Kt[e]))),o.a.createElement(i.B,null))),o.a.createElement(i.z,null,t.map(((t,s)=>o.a.createElement(i.D,{key:s},e.map((e=>o.a.createElement(i.A,{key:e},t[e]))),o.a.createElement(i.A,null,o.a.createElement(i.c,{small:!0,secondary:!0,onClick:()=>n(t)},o.a.createElement("span",{title:a?m.a.t("Batch delete lock exceptions"):m.a.t("Remove lock exception")},o.a.createElement(ot.a,{className:"material-icons"},"delete")))))))));var Ht=({onRemove:e,onClose:t})=>{const a=Object(_.b)(m.a.t("Lock exception removed"),{success:!0}),n=Object(_.b)((({error:e})=>m.a.t("Error removing lock exception: {{error}}",{error:e,nsSeparator:null})),{critical:!0}),[s,l]=Object(r.useState)(!1);return o.a.createElement(i.p,{onClose:t},o.a.createElement(i.s,null,m.a.t("Remove lock exception")),o.a.createElement(i.r,null,m.a.t("Are you sure you want to remove this lock exception?")),o.a.createElement(i.q,null,o.a.createElement(i.d,null,o.a.createElement(i.c,{disabled:s,onClick:t},m.a.t("No, cancel")),o.a.createElement(i.c,{destructive:!0,disabled:s,onClick:async()=>{l(!0);try{await e(),a.show(),t()}catch(i){n.show({error:i})}l(!1)}},s?o.a.createElement(o.a.Fragment,null,m.a.t("Removing lock exception..."),o.a.createElement(i.h,{small:!0})):m.a.t("Yes, remove lock exception")))))};function Xt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Zt extends r.Component{constructor(...e){super(...e),Xt(this,"state",{loading:!1,loaded:!1,error:null,pager:Zt.initialPager,atBatchDeletionPage:!1,levels:null,groups:null,dataSets:[],addLockExceptionModal:{isVisible:!1},removeLockExceptionModal:{isVisible:!1,lockException:null}}),Xt(this,"loadLockExceptionsForPager",(async(e,{userAction:t})=>{if(!t&&(this.state.loading||this.state.loaded))return;this.setState({atBatchDeletionPage:!1,loaded:!1,loading:!0,error:null});const a=(await Object(y.getInstance)()).Api.getApi(),n="lockExceptions?page=".concat(e.page,"&pageSize=").concat(e.pageSize)+"&fields=name,period[id,displayName],organisationUnit[id,displayName],dataSet[id,displayName]&order=name:asc";try{const e=await a.get(n);this.setState({loaded:!0,loading:!1,lockExceptions:this.prepareLockExceptionsResponseToDataTable(e.lockExceptions),pager:e.pager})}catch(i){const e=i&&i.message?i.message:m.a.t("Error loading lock exceptions");this.setState({loaded:!0,loading:!1,error:e})}})),Xt(this,"loadLockExceptionCombinations",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();this.setState({atBatchDeletionPage:!0,loaded:!1,loading:!0});try{const t=await e.get("lockExceptions/combinations?fields=name,period[id,displayName],dataSet[id,displayName]");this.setState({loaded:!0,loading:!1,atBatchDeletionPage:!0,lockExceptions:this.prepareLockExceptionsResponseToDataTable(t.lockExceptions)})}catch(t){const e=t&&t.message?t.message:m.a.t("An unexpected error happened during operation");this.setState({loaded:!0,loading:!1,error:e})}})),Xt(this,"handlePageChange",(e=>{const t={...this.state.pager,page:e};this.loadLockExceptionsForPager(t,{userAction:!0})})),Xt(this,"handlePageSizeChange",(e=>{const t={...this.state.pager,pageSize:e};this.loadLockExceptionsForPager(t,{userAction:!0})})),Xt(this,"backToLockExceptions",(()=>{this.loadLockExceptionsForPager(this.state.pager,{userAction:!0})})),Xt(this,"goToBatchDeletionPage",(()=>{this.loadLockExceptionCombinations()})),Xt(this,"handleShowRemoveLockExceptionModal",(e=>{this.setState({removeLockExceptionModal:{isVisible:!0,lockException:e}})})),Xt(this,"handleCloseRemoveLockExceptionModal",(()=>{this.setState({removeLockExceptionModal:{isVisible:!1,lockException:null}})})),Xt(this,"handleRemoveLockException",(async e=>{const t=(await Object(y.getInstance)()).Api.getApi();let a="lockExceptions?pe=".concat(e.periodId,"&ds=").concat(e.dataSetId);e.organisationUnitId&&(a+="&ou=".concat(e.organisationUnitId)),await t.delete(a),this.state.atBatchDeletionPage?this.setState({lockExceptions:this.state.lockExceptions.filter((t=>t.periodId!==e.periodId||t.dataSetId!==e.dataSetId))}):this.loadLockExceptionsForPager(Zt.initialPager,{userAction:!0})})),Xt(this,"handleShowAddLockExceptionModal",(async()=>{if(this.state.levels&&this.state.groups&&this.state.dataSets.length>0)return void this.setState({addLockExceptionModal:{isVisible:!0}});const e=await Object(y.getInstance)();try{const[t,a,n]=await Promise.all([e.models.organisationUnitLevel.list({paging:!1,fields:"id,level,displayName",order:"level:asc"}),e.models.organisationUnitGroup.list({paging:!1,fields:"id,displayName"}),e.models.dataSet.list({paging:!1,fields:"id,displayName,periodType"})]);this.setState({addLockExceptionModal:{isVisible:!0},levels:t,groups:a,dataSets:n.toArray()})}catch(t){const e=t&&t.message?t.message:m.a.t("An unexpected error happened during operation");this.setState({loading:!1,error:e})}})),Xt(this,"handleCloseAddLockExceptionModal",(()=>{this.setState({addLockExceptionModal:{isVisible:!1}})})),Xt(this,"handleAddLockException",(async({selectedOrgUnits:e,selectedDataSetId:t,selectedPeriodId:a})=>{const n=e.map((e=>{const t=e.split("/");return t[t.length-1]})),i=new FormData;i.append("ou","[".concat(n.join(","),"]")),i.append("pe",a),i.append("ds",t);const s=(await Object(y.getInstance)()).Api.getApi();await s.post("lockExceptions",i),this.loadLockExceptionsForPager(Zt.initialPager,{userAction:!1})}))}prepareLockExceptionsResponseToDataTable(e){return e.map((({dataSet:e,period:t,organisationUnit:a})=>{const n={period:t.displayName,periodId:t.id,dataSet:e.displayName,dataSetId:e.id};return this.state.atBatchDeletionPage||(n.organisationUnit=a.displayName,n.organisationUnitId=a.id),n}))}dataTableColumns(){return this.state.atBatchDeletionPage?["dataSet","period"]:["organisationUnit","dataSet","period"]}renderHeader(){return this.state.atBatchDeletionPage?o.a.createElement("div",{className:qt.a.headerContainer},o.a.createElement(ct.a,{onClick:this.backToLockExceptions},o.a.createElement("span",{title:m.a.t("Go back to all lock exceptions")},o.a.createElement(ot.a,{className:h()("material-icons",qt.a.backArrowIcon)},"arrow_back"))),o.a.createElement("h1",{className:qt.a.header},o.a.createElement("span",null,m.a.t("Lock Exception")),o.a.createElement("span",{className:qt.a.headerDivider}," | "),o.a.createElement("span",{className:qt.a.subHeader},m.a.t("Batch Deletion")))):o.a.createElement("div",{className:h()(qt.a.headerContainer,qt.a.flexSpaceBetween)},o.a.createElement(ge,{sectionKey:this.props.sectionKey,title:g.lockException.title}),o.a.createElement(i.d,null,o.a.createElement(i.c,{primary:!0,onClick:this.handleShowAddLockExceptionModal,disabled:this.areActionsDisabled()},m.a.t("Add lock exception")),o.a.createElement(i.c,{onClick:this.goToBatchDeletionPage,disabled:this.areActionsDisabled()},m.a.t("Batch deletion"))))}areActionsDisabled(){return this.state.loading}componentDidMount(){this.loadLockExceptionsForPager(Zt.initialPager,{userAction:!1})}renderPagination(){if(this.areActionsDisabled()||this.state.atBatchDeletionPage)return null;const e={...this.state.pager,onPageSizeChange:this.handlePageSizeChange,onPageChange:this.handlePageChange};return o.a.createElement("div",{className:qt.a.pagination},o.a.createElement(i.v,e))}renderTable(){var e;return(null===(e=this.state.lockExceptions)||void 0===e?void 0:e.length)>0?o.a.createElement("div",null,this.renderPagination(),o.a.createElement(Qt,{columns:this.dataTableColumns(),rows:this.state.lockExceptions,onRemoveLockException:this.handleShowRemoveLockExceptionModal,atBatchDeletionPage:this.state.atBatchDeletionPage}),this.renderPagination()):o.a.createElement("em",null,m.a.t("No lock exceptions to show."))}renderAddLockExceptionModal(){if(this.state.addLockExceptionModal.isVisible)return o.a.createElement(zt,{levels:this.state.levels,groups:this.state.groups,dataSets:this.state.dataSets,onAdd:this.handleAddLockException,onClose:this.handleCloseAddLockExceptionModal})}renderRemoveLockExceptionModal(){if(this.state.removeLockExceptionModal.isVisible)return o.a.createElement(Ht,{onRemove:()=>this.handleRemoveLockException(this.state.removeLockExceptionModal.lockException),onClose:this.handleCloseRemoveLockExceptionModal})}render(){return o.a.createElement("div",{className:qt.a.lockExceptions},this.renderHeader(),this.state.error?o.a.createElement(i.t,{error:!0},this.state.error):this.state.loading?o.a.createElement(i.f,null,o.a.createElement(i.h,null)):this.renderTable(),this.renderAddLockExceptionModal(),this.renderRemoveLockExceptionModal())}}Xt(Zt,"initialPager",{pageSize:20,page:1,total:0,pageCount:1}),Xt(Zt,"propTypes",{sectionKey:k.a.string.isRequired});var $t=Zt,ea=a(975),ta=a.n(ea);const aa=({checkboxes:e,toggleCheckbox:t,disabled:a})=>o.a.createElement("div",{className:ta.a.checkboxes},Object.entries(e).map((([e,n])=>o.a.createElement(i.g,{key:e,className:ta.a.checkbox,label:g.maintenance.checkboxes[e],checked:n,onChange:()=>t(e),disabled:a}))));var na=({sectionKey:e})=>{const{checkboxes:t,toggleCheckbox:a,toFormData:s}=(()=>{const[e,t]=Object(r.useState)((()=>{const e={};for(const t of Object.keys(g.maintenance.checkboxes))e[t]=!1;return e}));return{checkboxes:e,toggleCheckbox:a=>{t({...e,[a]:!e[a]})},toFormData:()=>{const t=new FormData;return Object.entries(e).forEach((([e,a])=>{t.append(e,a)})),t}}})(),l=Object(_.b)(m.a.t("Maintenance done"),{success:!0}),c=Object(_.b)((({message:e})=>e),{critical:!0}),{d2:d}=Object(n.a)(),[p,u]=Object(r.useState)(!1);return o.a.createElement("div",null,o.a.createElement(ge,{sectionKey:e,title:g.maintenance.title}),o.a.createElement(i.e,{className:ta.a.card},o.a.createElement(aa,{checkboxes:t,toggleCheckbox:a,disabled:p}),o.a.createElement(i.c,{primary:!0,disabled:p||!Object.values(t).some((e=>e)),onClick:async()=>{const e=d.Api.getApi(),t=s();u(!0);try{await e.post("maintenance",t),l.show()}catch(a){c.show({message:a.message||m.a.t("An unexpected error happened during maintenance")})}u(!1)}},p?o.a.createElement(o.a.Fragment,null,m.a.t("Performing maintenance..."),o.a.createElement(i.h,{small:!0})):m.a.t("Perform maintenance"))))};function ia(){return(ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var sa=a(976),ra=a.n(sa);function oa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const la="/minMaxValues",ca=e=>{return(t=e.split("/"))[t.length-1];var t};class da extends r.Component{constructor(...e){super(...e),oa(this,"state",{loading:!0,error:null,selectedOrganisationUnit:null,dataSets:null,roots:null,dataSetsSelectedCount:0}),oa(this,"isFormValid",(()=>this.state.dataSetsSelectedCount>0&&null!==this.state.selectedOrganisationUnit)),oa(this,"loadData",(async()=>{const e=await Object(y.getInstance)();try{const[t,a]=await Promise.all([e.models.organisationUnits.list({paging:!1,level:1,fields:"id"}),e.models.dataSet.list({paging:!1,fields:"id,displayName"})]);this.setState({roots:t.toArray(),dataSets:a.toArray()})}catch(t){this.setState({error:m.a.t("Error loading data")})}this.setState({loading:!1})})),oa(this,"dataSetsSelectRef",(e=>{this.dataSetsSelect=e})),oa(this,"dataSetsSelectClick",(()=>{this.setState({dataSetsSelectedCount:this.dataSetsSelect.selectedOptions.length})})),oa(this,"getDataSetIds",(()=>Array.from(this.dataSetsSelect.selectedOptions).map((({value:e})=>e)))),oa(this,"handleOrganisationUnitChange",(({path:e,checked:t})=>{t?this.setState({selectedOrganisationUnit:{path:e,id:ca(e)}}):this.setState({selectedOrganisationUnit:null})})),oa(this,"handleGenerateMinMaxValue",(async()=>{this.props.alert.show({message:m.a.t("Generating min-max values..."),success:!0});const e=(await Object(y.getInstance)()).Api.getApi();try{await e.post(la,{organisationUnit:this.state.selectedOrganisationUnit.id,dataSets:this.getDataSetIds()}),this.props.alert.show({message:m.a.t("Min-max values generated"),success:!0})}catch(t){this.props.alert.show({message:m.a.t("Error generating min-max values"),critical:!0})}})),oa(this,"handleRemoveMinMaxValue",(async()=>{this.props.alert.show({message:m.a.t("Removing min-max values..."),success:!0});const e=this.getDataSetIds(),t=(await Object(y.getInstance)()).Api.getApi();try{await t.delete("".concat(la,"/").concat(this.state.selectedOrganisationUnit.id,"?ds=").concat(e)),this.props.alert.show({message:m.a.t("Min-max values removed"),success:!0})}catch(a){this.props.alert.show({message:m.a.t("Error removing min-max values"),critical:!0})}}))}componentDidMount(){this.loadData()}isUserInteractionDisabled(){return this.state.loading||null==this.state.dataSets||null===this.state.roots}renderForm(){return o.a.createElement(i.e,{className:ra.a.card},o.a.createElement("div",{className:ra.a.container},o.a.createElement("div",{className:ra.a.left},o.a.createElement("div",{className:ra.a.label},m.a.t("Data set")),o.a.createElement("select",{multiple:!0,onClick:this.dataSetsSelectClick,className:ra.a.select,ref:this.dataSetsSelectRef},this.state.dataSets.map((e=>o.a.createElement("option",{key:e.id,value:e.id,className:ra.a.options},e.displayName))))),o.a.createElement("div",{className:ra.a.right},o.a.createElement("div",{className:ra.a.label},m.a.t("Organisation unit")),o.a.createElement("div",{className:ra.a.tree},o.a.createElement(i.u,{roots:this.state.roots.map((e=>e.id)),singleSelection:!0,selected:this.state.selectedOrganisationUnit?[this.state.selectedOrganisationUnit.path]:[],onChange:this.handleOrganisationUnitChange})))),o.a.createElement(i.d,null,o.a.createElement(i.c,{primary:!0,onClick:this.handleGenerateMinMaxValue,disabled:!this.isFormValid()},m.a.t("Generate min-max values")),o.a.createElement(i.c,{destructive:!0,onClick:this.handleRemoveMinMaxValue,disabled:!this.isFormValid()},m.a.t("Remove min-max values"))))}render(){return o.a.createElement("div",null,o.a.createElement(ge,{sectionKey:this.props.sectionKey,title:g.minMaxValueGeneration.title}),this.state.error?o.a.createElement(i.t,{error:!0},this.state.error):this.state.loading?o.a.createElement(i.f,null,o.a.createElement(i.h,null)):this.renderForm())}}oa(da,"propTypes",{alert:k.a.object.isRequired,sectionKey:k.a.string.isRequired});var pa,ua=(pa=da,function(e){const t=Object(_.b)((({message:e})=>e),(e=>e));return o.a.createElement(pa,ia({},e,{alert:t}))});const ha="system/tasks/RESOURCE_TABLE";var ma=a(977),ga=a.n(ma);function ya(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const ba=[{key:"organisationUnitStructure",name:"_orgunitstructure"},{key:"organistionUnitCategoryOptionCombo",name:"_orgunitstructure"},{key:"categoryOptionGroupSetStructure",name:"_categoryoptiongroupsetstructure"},{key:"dataElementGroupSetStructure",name:"_dataelementgroupsetstructure"},{key:"indicatorGroupSetStructure",name:"_indicatorgroupsetstructure"},{key:"organisationUnitGroupSetStructure",name:"_organisationunitgroupsetstructure"},{key:"categoryStructure",name:"_categorystructure"},{key:"dataElementCategoryOptionComboName",name:"_categoryoptioncomboname"},{key:"dataElementStructure",name:"_dataelementstructure"},{key:"periodStructure",name:"_periodstructure"},{key:"dataPeriodStructure",name:"_dateperiodstructure"},{key:"dataElementCategoryOptionCombinations",name:"_dataelementcategoryoptioncombo"}];class ka extends r.Component{constructor(){super(),ya(this,"startTaskProgressPolling",(()=>{this.intervalId=setInterval((()=>{this.requestTaskProgress()}),5e3)})),ya(this,"initResourceTablesGeneration",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();this.setLoadingPageState();try{const{response:t}=await e.post("resourceTables");t&&this.setState({taskId:t.id},this.startTaskProgressPolling)}catch(t){this.setLoadedPageWithErrorState(t)}})),ya(this,"requestTaskSummary",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();try{const t=await e.get(ha),a=this.getActiveTaskIdFromSummary(t);a&&(this.setLoadingPageState(),this.setState({taskId:a,notifications:this.getUpdatedNotifications(t[a])},this.startTaskProgressPolling))}catch(t){this.setLoadedPageWithErrorState(t)}})),ya(this,"requestTaskProgress",(async()=>{const e=(await Object(y.getInstance)()).Api.getApi();try{const t=await e.get("".concat(ha,"/").concat(this.state.taskId));this.isTaskCompleted(t)&&(this.stopTaskProgressPolling(),this.unsetLoadingPageState()),this.setState({notifications:this.getUpdatedNotifications(t)})}catch(t){this.setLoadedPageWithErrorState(t)}})),this.state={taskId:null,notifications:[],loading:!1,error:null}}componentWillUnmount(){this.stopTaskProgressPolling()}stopTaskProgressPolling(){clearInterval(this.intervalId),this.intervalId=null}setLoadingPageState(){this.setState({loading:!0,error:null,notifications:[]})}unsetLoadingPageState(){this.setState({loading:!1})}setLoadedPageWithErrorState(e){const t=null!==e&&void 0!==e&&e.message?e.message:g.resourcetables.unexpectedError;this.stopTaskProgressPolling(),this.setState({error:t,loading:!1})}getUpdatedNotifications(e=[]){if(e.length<=this.state.notifications.length)return this.state.notifications;const t=e.length-1;return e.reverse().map(((e,a)=>({...e,completed:e.completed||a<t})))}getActiveTaskIdFromSummary(e){const{taskId:t}=Object.entries(e).reduce(((e,[t,a])=>{const n=a[a.length-1],i=new Date(n.time);return!this.isTaskCompleted(a)&&i>e.time?{taskId:t,time:i}:e}),{taskId:null,time:new Date(0)});return t}isTaskCompleted(e){return e[0].completed}render(){var e;return o.a.createElement("div",null,o.a.createElement(ge,{title:g.resourceTables.title,sectionKey:this.props.sectionKey}),o.a.createElement(i.e,{className:ga.a.card},this.state.error&&o.a.createElement(i.t,{className:ga.a.noticeBox,error:!0},this.state.error),o.a.createElement("div",{className:ga.a.description},ba.map((e=>o.a.createElement("div",{key:e.key},g.resourceTables.tables[e.key],o.a.createElement("span",{title:"Table name",className:ga.a.tableName},"(",e.name,")"))))),o.a.createElement(i.c,{primary:!0,onClick:this.initResourceTablesGeneration,disabled:this.state.loading},m.a.t("Generate tables"))),(null===(e=this.state.notifications)||void 0===e?void 0:e.length)>0&&o.a.createElement(i.e,{className:ga.a.card},o.a.createElement(w,{notifications:this.state.notifications,animateIncomplete:!0})))}}ya(ka,"propTypes",{sectionKey:k.a.string.isRequired});var Ea=ka;const va=[{key:"dataIntegrity",path:"/data-integrity",component:Ve,info:{label:g.dataIntegrity.label,icon:"link",description:g.dataIntegrity.description,actionText:g.dataIntegrity.actionText,docs:"dataAdmin_dataIntegrity"}},{key:"maintenance",path:"/maintenance",component:na,info:{label:g.maintenance.label,icon:"settings",description:g.maintenance.description,actionText:g.maintenance.actionText,docs:"data_admin_maintenance"}},{key:"resourceTables",path:"/resourceTables",component:Ea,info:{label:g.resourceTables.label,icon:"view_list",description:g.resourceTables.description,actionText:g.resourceTables.actionText,docs:"dataAdmin_resourceTables"}},{key:"analytics",path:"/analytics",component:Pe,info:{label:g.analytics.label,icon:"multiline_chart",description:g.analytics.description,actionText:g.analytics.actionText,docs:"generate_analytics_tables"}},{key:"statistics",path:"/data-statistics",component:st,info:{label:g.dataStatistics.label,icon:"timeline",description:g.dataStatistics.description,actionText:g.dataStatistics.actionText,docs:"dataAdmin_dataStatistics"}},{key:"lock",path:"/lock-exception",component:$t,info:{label:g.lockException.label,icon:"lock",description:g.lockException.description,actionText:g.lockException.actionText,docs:"dataAdmin_lockException"}},{key:"minMax",path:"/min-max-value-generation",component:ua,info:{label:g.minMaxValueGeneration.label,icon:"compare_arrows",description:g.minMaxValueGeneration.description,actionText:g.minMaxValueGeneration.actionText,docs:"dataAdmin_minMaxValueGeneration"}}],Sa=e=>{var t;return(null===(t=va.find((t=>t.key===e)))||void 0===t?void 0:t.info.docs)||""};var xa,fa,Ca,Pa=a(415),Oa=a(978),wa=a.n(Oa);class _a extends r.PureComponent{render(){return o.a.createElement(l.b,{to:this.props.section.path},o.a.createElement(Pa.GridTile,{key:this.props.section.key,className:h()("section",wa.a.gridElement)},o.a.createElement("div",{className:h()("row",wa.a.gridTitleBar)},o.a.createElement("span",{className:h()("section-title",wa.a.gridTitleDescription)},this.props.section.info.label),o.a.createElement(ot.a,{className:h()("material-icons","icon",wa.a.gridIcon)},this.props.section.info.icon)),o.a.createElement("span",{className:h()("section-description","row",wa.a.gridDescription)},this.props.section.info.description),o.a.createElement("span",{className:h()("section-action-text","row",wa.a.gridActionText)},this.props.section.info.actionText)))}}xa=_a,fa="propTypes",Ca={section:k.a.shape({info:k.a.shape({actionText:k.a.string,description:k.a.string,icon:k.a.string,label:k.a.string}),key:k.a.string,path:k.a.string}).isRequired},fa in xa?Object.defineProperty(xa,fa,{value:Ca,enumerable:!0,configurable:!0,writable:!0}):xa[fa]=Ca;var Ta=_a,Da=a(984),Na=a.n(Da);a(985);var Ra=()=>{const e=va.map((e=>o.a.createElement("div",{key:e.key,className:h()("col-sm-12 col-md-6 col-lg-4",Na.a.gridContainer)},o.a.createElement(Ta,{key:e.key,section:e}))));return o.a.createElement("div",{id:"grid-list-id",className:"row"},e)};function Aa(){return(Aa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Ia=()=>o.a.createElement(p.d,null,o.a.createElement(p.b,{exact:!0,path:"/",component:Ra}),va.map((e=>o.a.createElement(p.b,{key:e.key,path:e.path,component:t=>o.a.createElement(e.component,Aa({sectionKey:e.key},t))}))),o.a.createElement(p.a,{from:"*",to:"/"})),ja=a(986),Ma=a.n(ja);const La=({label:e,path:t})=>{const a=Object(p.g)(),n=!!Object(p.h)(t);return o.a.createElement(i.o,{className:Ma.a.sidebarItem,onClick:()=>a.push(t),active:n,label:e})};var Ua=()=>o.a.createElement(i.n,null,va.map((e=>o.a.createElement(La,{key:e.key,label:e.info.label,path:e.path})))),Wa=a(308),Ba=a(336),Ga=a.n(Ba),Va=a(337),Fa=a.n(Va),Ja=a(286);const za={spacing:Fa.a,fontFamily:"Roboto, sans-serif",palette:{primary1Color:"#004ba0",primary2Color:Wa.blue700,primary3Color:Wa.blue100,accent1Color:Wa.orange500,accent2Color:Wa.grey100,accent3Color:Wa.orangeA200,textColor:Wa.darkBlack,alternateTextColor:Wa.white,canvasColor:Wa.white,borderColor:Wa.grey400,disabledColor:Object(Ja.fade)(Wa.darkBlack,.3)}};var Ya=Ga()(za);a(987);t.default=()=>{const{d2:e}=Object(n.a)();return e?o.a.createElement(l.a,null,o.a.createElement(i.j,{spacers:!0,colors:!0}),o.a.createElement(s.MuiThemeProvider,{muiTheme:Ya},o.a.createElement("div",{className:d.a.container},o.a.createElement("div",{className:d.a.sidebar},o.a.createElement(Ua,null)),o.a.createElement("main",{className:d.a.content},o.a.createElement("div",{className:d.a.contentWrapper},o.a.createElement(Ia,null)))))):null}}}]);
//# sourceMappingURL=app.cc421a7c.chunk.js.map